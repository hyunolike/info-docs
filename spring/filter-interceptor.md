## `Filter` `Interceptor`
> [참고자료](https://mangkyu.tistory.com/173)
- ✔ 스프링은 공통적으로 여러 작업을 처리함으로써 중복된 코드 제거할 수 있는 기능들 제공!!
- ![image](https://user-images.githubusercontent.com/61215550/199182163-2ef54fa1-f740-4f04-b5e1-9f8b2116b933.png)


### `Filter`
> `J2EE` 자바 기술로 기업환경의 어플리케이션을 만드는데 필요한 스펙들을 모아둔 스펙 집합
- `J2EE 표준 스펙 기능` >> 디스패처 서블릿에 요청이 전달되기 전/후에 url 패턴에 맞는 모든 요청에 대해 부가작업을 처리할 수 있는 기능 제공
  - ✔ 디스패처 서블릿: 스프링의 가장 앞단 존재하는 프론트 컨트롤러, `스프링 범위 밖에서 처리`
  - ⭐ 즉, 스프링 컨테이너 아니고 !! 톰캣과 같은 웹 컨테이너에 의해 관리가 되는 것(`스프링 빈`) / 디스패처 서블릿 전/후에 처리

#### 1. 필터 메소드
- `init` 메소드
- `doFilter` 메소드
- `destroy` 메소드

### `Interceptor`
- `스프링이 제공하는 기술` 
- 디스패처 서블릿이 **컨트롤러** 를 호출하기 전과 후에 요청과 응답을 참조하거나 가공할 수 있는 기능

#### 1. 인터셉터 메소드
- `preHandle` 메소드
- `postHandle` 메소드
- `afterCompletion` 메소드

### `filter` `interceptor` 차이
|대상|필터|인터셉터|
|----|----|-----|
|관리되는 컨테이너|웹 컨테이너|스프링 컨테이너|
|Request/Response 객체 조작 가능 여부|⭕|❌|


#### 필터 용도
- 공통된 보안 및 인증/인가 관련 작업
- 모든 요청에 대한 로깅 또는 감사 
- 이미지/데이터 압축 및 문자열 인코딩 
- Spring과 분리되어야 하는 기능
- 예시 >> ✔스프링과 무관하게 전역적으로 처리해야 하는 작업들
  - 대표적으로 보안 공통 작업  

#### 인터셉터 용도
- 세부적인 보안 및 인증/인가 공통 작업
- API 호출에 대한 로깅 또는 감사
- Controller 로 넘겨주는 정보(데이터)의 가공
- 예시  >> ✔클라이너트의 요청과 관련되어 전역적으로 처리해아 하는 용도
  - 컨트롤러로 넘겨주기 위한 정보를 가공  

## (추가) ⭐ 서블릿 필터는 스프링 빈으로도 등록이 가능!! 
> [참고자료](https://mangkyu.tistory.com/221)
- `DelegatingFilterProxy` 등장 이후, 스프링 빈으로 등록 가능해짐~ 이거는 ✔ 스프링에서만!! 스프링부트는 아니야
### 1. `DelegatingFilterProxy` `SpringBoot` 등장
- 필터에서도 DI와 같은 스프링 기술 필요로 하는 상황 발생 그래서 저거 나옴 ㅋㅋㅋ
### 2. ⭐ 동작 원리
1. Filter 구현체가 스프링 빈으로 등록됨
2. ServletContext가 Filter 구현체를 갖는 DelegatingFilterProxy 생성
3. ServletContext가 DelegatingFilterProxy를 서블릿 컨테이너에 필터로 등록
4. 요청이 오면 DelegatingFilterProxy가 필터 구현체에게 요청을 위임하여 필터 처리 진행

### 3. ⭐ 스프링부트는 내장 웹서버 지원하면서 톰켓과 같은 서블릿 컨테이너까지 제어 가능
- 스프링부트가 서블릿 필터의 구현체 빈 찾으면 바로 필터 체인에 필터 등록해줌

### 4. 정리
- 등장 배경: 필터에서 다른 스프링 빈의 주입이 필요해짐
- `DelegatingFilterProxy` 등장 이전: 스프링 빈으로 등록 및 다른 빈 주입이 불가능했음
- `DelegatingFilterProxy` 등장 이후: 이걸 통해 스프링 빈으로 등록 및 다른 빈 주입이 가능해짐
- SpringBoot 등장 이후: 웹서버를 직접 관리하면서 DelegatingFilterProxy 필요없어짐
