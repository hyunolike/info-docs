## JPA 영속성 컨텍스트
- JPA는 왜 영속성 컨텍스트 사용??
  - ⭐애플리케이션 <-- [영속성 컨텍스트(중간계층)] --> 데이터베이스 있기에!
  - 버퍼링, 캐싱 등 할 수 있게 됨!
### 1차 캐시
- 영속성 컨텍스트 >> 1차 캐시 존재 >> `Map<KEY, VALUE>` 저장
- `entityManager` `find()` 메소드 호출 시 >> 영속성 컨텍스트의 1차 캐시 조회

### 동일성 보장
- 하나의 트랜잭션에서 같은 키값 >> 영속성 컨텍스트 저장된 엔티티 조회 시 같은 엔티티 조회 보장
- ✔ 1차 캐시에 저장된 엔티티 조회 가능

### 트랜잭션을 지원하는 쓰기 지연
- `entityManager.persist()` 호출 >> 1차 캐시 저장되는 것 & 쓰기 지연 SQL 저장소에 SQL 저장
- ✔ 이렇게 SQL 쌓아두고 트랜잭션 커밋하느 시점에 저장된 SQL문들이 flush 되면서 데이터베이스 반영!
  - 모아서 보내기에 >> 성능 이점!

### 변경감지
- 1차 캐시에 데이터베이스에 처음 불러온 엔티티의 스냅샷 값 갖고 있음
- 1차 캐시에 저장된 엔티티와 스냅샷 비교 후 커밋 내용 있으면 `update sql`문 **쓰기 지연 sql 저장소** 에 담아둠
- ⭐업데이트 쿼리 호출 필요 없어짐!!
